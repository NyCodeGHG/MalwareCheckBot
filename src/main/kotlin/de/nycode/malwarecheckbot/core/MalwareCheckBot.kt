package de.nycode.malwarecheckbot.core

import de.nycode.malwarecheckbot.filtering.MalwareDetector
import de.nycode.malwarecheckbot.storage.GuildInformation
import dev.kord.core.Kord
import dev.kord.core.entity.Guild
import dev.kord.core.event.message.MessageCreateEvent
import io.lettuce.core.api.coroutines.RedisCoroutinesCommands
import kotlinx.coroutines.CoroutineScope
import org.litote.kmongo.coroutine.CoroutineClient
import org.litote.kmongo.coroutine.CoroutineCollection

interface MalwareCheckBot : CoroutineScope {
    val kord: Kord
    val repositories: MongoRepositories
    val redis: RedisCoroutinesCommands<String, String>
    val malwareDetector: MalwareDetector

    suspend fun Guild.information(): GuildInformation?
    suspend fun MessageCreateEvent.information(): GuildInformation?
}

class MongoRepositories(val client: CoroutineClient, val guilds: CoroutineCollection<GuildInformation>)
