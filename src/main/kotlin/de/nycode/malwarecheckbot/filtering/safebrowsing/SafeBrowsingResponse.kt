package de.nycode.malwarecheckbot.filtering.safebrowsing

import de.nycode.malwarecheckbot.serialization.MetadataEntryMapSerializer
import kotlinx.serialization.Serializable

@Serializable
data class SafeBrowsingResponse(val matches: List<ThreatMatch> = emptyList())

@Serializable
data class ThreatMatch(
    val threatType: ThreatType,
    val platformType: PlatformType,
    val threatEntryType: ThreatEntryType,
    val threat: ThreatEntry,
    @Serializable(with = MetadataEntryMapSerializer::class)
    val threatEntryMetadata: Map<String, String> = emptyMap(),
    val cacheDuration: String
)
